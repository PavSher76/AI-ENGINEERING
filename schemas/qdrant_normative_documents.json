{
  "collection_name": "normative_documents",
  "description": "Коллекция нормативно-технических документов для RAG-системы консультаций по НТД",
  "vector_config": {
    "size": 1536,
    "distance": "Cosine",
    "on_disk": true
  },
  "payload_schema": {
    "type": "object",
    "required": [
      "doc_id",
      "doc_title", 
      "doc_family",
      "edition_year",
      "is_current",
      "section",
      "clause",
      "breadcrumbs",
      "ingest_ts"
    ],
    "properties": {
      "doc_id": {
        "type": "string",
        "description": "Уникальный идентификатор документа",
        "pattern": "^[a-z0-9-]+$",
        "examples": ["gost-21.201-2011", "sp-131.13330.2020", "fnp-001-2018"]
      },
      "doc_title": {
        "type": "string",
        "description": "Полное название документа",
        "examples": ["ГОСТ 21.201-2011", "СП 131.13330.2020", "ФНП-001-2018"]
      },
      "doc_family": {
        "type": "string",
        "enum": ["ГОСТ", "СП", "ФНП", "ПУЭ", "СНиП", "РД", "МДС", "ВСН", "ТСН", "СанПиН", "СН", "НПБ", "ПБ", "ПОТ", "ПУБЭ", "ПУЭ", "ПУГ", "ПУГС", "ПУГСН", "ПУГСП", "ПУГСР", "ПУГСТ", "ПУГСУ", "ПУГСФ", "ПУГСХ", "ПУГСЦ", "ПУГСЧ", "ПУГСШ", "ПУГСЩ", "ПУГСЭ", "ПУГСЮ", "ПУГСЯ"],
        "description": "Семейство нормативного документа"
      },
      "discipline": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": ["АП", "КИПиА", "ЭО", "ВК", "ОВ", "ТС", "ПБ", "ЭМ", "СВ", "СС", "ГС", "АВТ", "СПУ", "СПС", "СПТ", "СПУ", "СПФ", "СПХ", "СПЦ", "СПЧ", "СПШ", "СПЩ", "СПЭ", "СПЮ", "СПЯ"]
        },
        "description": "Дисциплины, к которым относится документ",
        "examples": [["АП", "КИПиА"], ["ПБ"], ["ЭО", "ВК"]]
      },
      "edition_year": {
        "type": "integer",
        "minimum": 1950,
        "maximum": 2030,
        "description": "Год издания документа"
      },
      "is_current": {
        "type": "boolean",
        "description": "Актуальность документа (не отменен)"
      },
      "effective_from": {
        "type": "string",
        "format": "date",
        "description": "Дата вступления в силу",
        "examples": ["2012-01-01", "2020-07-01"]
      },
      "canceled_by": {
        "type": ["string", "null"],
        "description": "Документ, которым отменен данный",
        "examples": [null, "ГОСТ 21.201-2018"]
      },
      "status": {
        "type": "string",
        "enum": ["active", "canceled", "replaced", "draft"],
        "description": "Статус документа"
      },
      "section": {
        "type": "string",
        "description": "Номер раздела",
        "examples": ["4", "5.1", "Приложение А"]
      },
      "clause": {
        "type": "string", 
        "description": "Номер пункта/подпункта",
        "examples": ["4.2", "5.1.3", "А.1.2"]
      },
      "clause_title": {
        "type": "string",
        "description": "Заголовок пункта",
        "examples": ["Область применения", "Требования к проектированию", "Определения"]
      },
      "breadcrumbs": {
        "type": "string",
        "description": "Иерархический путь к фрагменту",
        "examples": ["ГОСТ 21.201-2011 > 4 > 4.2", "СП 131.13330.2020 > 5 > 5.1 > 5.1.3"]
      },
      "page_from": {
        "type": "integer",
        "minimum": 1,
        "description": "Начальная страница фрагмента"
      },
      "page_to": {
        "type": "integer", 
        "minimum": 1,
        "description": "Конечная страница фрагмента"
      },
      "source_url": {
        "type": "string",
        "description": "URL источника в системе Техэксперт",
        "pattern": "^pte-ntd://",
        "examples": ["pte-ntd://gost-21.201-2011#4.2", "pte-ntd://sp-131.13330.2020#5.1.3"]
      },
      "techexpert_doc_id": {
        "type": "string",
        "description": "ID документа в системе Техэксперт",
        "examples": ["TE_12345", "TE_67890"]
      },
      "techexpert_edition_id": {
        "type": "string",
        "description": "ID редакции в системе Техэксперт",
        "examples": ["ED_12345_v2", "ED_67890_v1"]
      },
      "checksum": {
        "type": "string",
        "description": "Контрольная сумма содержимого",
        "pattern": "^[a-f0-9]{32}$"
      },
      "content_type": {
        "type": "string",
        "enum": ["definition", "requirement", "reference", "example", "note", "table", "formula"],
        "description": "Тип содержимого фрагмента"
      },
      "keywords": {
        "type": "array",
        "items": {"type": "string"},
        "description": "Ключевые слова для улучшения поиска",
        "examples": [["область применения", "сфера действия"], ["требования", "нормы"]]
      },
      "related_docs": {
        "type": "array",
        "items": {"type": "string"},
        "description": "Связанные документы",
        "examples": [["ГОСТ 21.201-2018"], ["СП 131.13330.2020", "СНиП 23-01-99"]]
      },
      "ingest_ts": {
        "type": "string",
        "format": "date-time",
        "description": "Время индексации в систему"
      },
      "last_updated": {
        "type": "string",
        "format": "date-time", 
        "description": "Время последнего обновления"
      }
    }
  },
  "indexing_config": {
    "chunk_size": 1000,
    "chunk_overlap": 150,
    "min_chunk_size": 200,
    "max_chunk_size": 1200,
    "preserve_structure": true,
    "include_headers": true
  },
  "search_config": {
    "hybrid_weights": {
      "vector_weight": 0.6,
      "bm25_weight": 0.4
    },
    "rerank_top_k": 50,
    "final_top_k": 10,
    "similarity_threshold": 0.7,
    "max_results": 100
  },
  "filters": {
    "common_filters": {
      "active_documents": {
        "must": [
          {"key": "is_current", "match": {"value": true}},
          {"key": "status", "match": {"value": "active"}}
        ]
      },
      "gost_only": {
        "must": [
          {"key": "doc_family", "match": {"value": "ГОСТ"}},
          {"key": "is_current", "match": {"value": true}}
        ]
      },
      "recent_editions": {
        "must": [
          {"key": "edition_year", "range": {"gte": 2020}},
          {"key": "is_current", "match": {"value": true}}
        ]
      }
    }
  }
}
