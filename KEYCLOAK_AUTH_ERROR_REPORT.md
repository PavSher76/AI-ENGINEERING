# –û—Ç—á–µ—Ç –æ–± –æ—à–∏–±–∫–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Keycloak

## üö® –û—à–∏–±–∫–∞
```
logger.ts:63 [2025-10-10T04:39:50.348Z] [ERROR] [AUTH] –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Keycloak Object
```

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ **–í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚ùå **–í –±—Ä–∞—É–∑–µ—Ä–µ:** `process.env` –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ production build
- ‚ùå **Environment –æ–±—ä–µ–∫—Ç:** `window.environment` –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Keycloak
- ‚úÖ **Keycloak –∑–∞–ø—É—â–µ–Ω:** –°–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 9080 (HTTPS) –∏ 9081 (HTTP)
- ‚ùå **SSL –ø—Ä–æ–±–ª–µ–º—ã:** –û—à–∏–±–∫–∏ SSL —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å Keycloak
- ‚ùå **–ü–æ—Ä—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç:** Nginx –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç 9081

### 3. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚ùå **ReactKeycloakProvider:** –ù–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚ùå **AuthContext:** –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ùå **–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ù–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ Keycloak

## üõ†Ô∏è –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Keycloak
```yaml
# docker-compose.yml
KC_HTTP_ENABLED: true
KC_HTTPS_ENABLED: false
KC_HTTP_PORT: 8081
KC_HTTPS_PORT: 9080
```

### 2. –ò–∑–º–µ–Ω–µ–Ω—ã –ø–æ—Ä—Ç—ã
```yaml
# docker-compose.yml
ports:
  - "9080:8080"  # HTTPS
  - "9082:8081"  # HTTP (–Ω–æ–≤—ã–π –ø–æ—Ä—Ç)
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
```typescript
// frontend/src/config/environment.ts
keycloak: {
  url: 'http://localhost:9082', // HTTP –≤–º–µ—Å—Ç–æ HTTPS
  realm: 'ai-engineering',
  clientId: 'ai-frontend',
}
```

### 4. Hardcoded –∑–Ω–∞—á–µ–Ω–∏—è
- –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–º–µ–Ω–∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –≠—Ç–æ –¥–æ–ª–∂–Ω–æ —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å `process.env` –≤ production build

## üö® –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ production build
**–ü—Ä–æ–±–ª–µ–º–∞:** React –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ `process.env` –≤ production build
**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ (hardcoded –∑–Ω–∞—á–µ–Ω–∏—è)

### 2. Keycloak –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–ü—Ä–æ–±–ª–µ–º–∞:** Keycloak –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ HTTP –∑–∞–ø—Ä–æ—Å—ã
**–ü—Ä–∏—á–∏–Ω–∞:** –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø–æ—Ä—Ç–æ–≤

### 3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
**–ü—Ä–æ–±–ª–µ–º–∞:** `ReactKeycloakProvider` –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Keycloak

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Keycloak
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ Keycloak –Ω–∞ –Ω–æ–≤–æ–º –ø–æ—Ä—Ç—É
curl -s "http://localhost:9082/realms/ai-engineering/.well-known/openid-configuration"
```

### 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
docker-compose build --no-cache frontend
docker-compose up -d frontend
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Keycloak
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Keycloak –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫
docker logs ai-engineering-keycloak-1 --tail 50
```

### 4. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS
–ï—Å–ª–∏ HTTP –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ:
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Keycloak
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è Keycloak

## üìä –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|---------|
| Keycloak —Å–µ—Ä–≤–µ—Ä | ‚úÖ | –ó–∞–ø—É—â–µ–Ω –∏ —Å–ª—É—à–∞–µ—Ç |
| Keycloak HTTP | ‚ùå | –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 9082 |
| Keycloak HTTPS | ‚ùå | SSL –æ—à–∏–±–∫–∏ |
| –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è | ‚ùå | –ù–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ production |
| ReactKeycloakProvider | ‚ùå | –ù–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω |
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | ‚ùå | –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |

## üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Keycloak** –Ω–∞ –ø–æ—Ä—Ç—É 9082
2. **–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥** —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é** –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏** –∏—Å–ø—Ä–∞–≤–∏—Ç—å SSL –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å development —Ä–µ–∂–∏–º
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ development —Ä–µ–∂–∏–º–µ
npm start
```

### 2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è Keycloak
openssl req -x509 -newkey rsa:4096 -keyout keycloak.key -out keycloak.crt -days 365 -nodes
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è
```nginx
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è Keycloak
location /auth/ {
    proxy_pass http://keycloak:8080/;
}
```

–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - Keycloak –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ HTTP –ø–æ—Ä—Ç—É, —á—Ç–æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.
